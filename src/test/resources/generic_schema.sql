CREATE TABLE subject (
    subject_id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    birth_date timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    sex        text   NOT NULL,
    PRIMARY KEY (subject_id)
);

CREATE TABLE weight (
    phenotype_id    bigint                   NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    subject_id      bigint                   NOT NULL REFERENCES subject,
    created_at      timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    code_system     text   NOT NULL,
    code            text   NOT NULL,
    unit            text,
    number_value    numeric,
    text_value      text,
    date_time_value timestamp,
    boolean_value   boolean,
    PRIMARY KEY (phenotype_id)
);

CREATE TABLE height (
    phenotype_id    bigint                   NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    subject_id      bigint                   NOT NULL REFERENCES subject,
    created_at      timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    code_system     text   NOT NULL,
    code            text   NOT NULL,
    unit            text,
    number_value    numeric,
    text_value      text,
    date_time_value timestamp,
    boolean_value   boolean,
    PRIMARY KEY (phenotype_id)
);

INSERT INTO subject VALUES
    (1, current_date - '22' year, 'female'),
    (2, current_date - '42' year, 'female'),
    (3, current_date - '22' year, 'male'),
    (4, current_date - '42' year, 'male'),
    (5, current_date - '22' year, 'female');

INSERT INTO weight (subject_id, created_at, code_system, code, unit, number_value) VALUES
    (1, '2000-05-20T12:43:00', 'http://loinc.org', '3141-9', 'kg', 75),
    (2, '2000-12-01T06:35:00', 'http://loinc.org', '3141-9', 'kg', 85),
    (3, '2000-05-20T12:43:00', 'http://loinc.org', '3141-9', 'kg', 75),
    (4, '2000-12-01T06:35:00', 'http://loinc.org', '3141-9', 'kg', 85),
    (5, '2000-05-20T12:43:00', 'http://loinc.org', '3141-9', 'kg', 75);

INSERT INTO height (subject_id, created_at, code_system, code, unit, number_value) VALUES
    (1, '2000-05-20T12:43:00', 'http://loinc.org', '3137-7', 'cm', 170),
    (2, '2000-12-01T06:35:00', 'http://loinc.org', '3137-7', 'cm', 180),
    (3, '2000-05-20T12:43:00', 'http://loinc.org', '3137-7', 'cm', 170),
    (4, '2000-12-01T06:35:00', 'http://loinc.org', '3137-7', 'cm', 180),
    (5, '2000-05-20T12:43:00', 'http://loinc.org', '3137-7', 'cm', null);
