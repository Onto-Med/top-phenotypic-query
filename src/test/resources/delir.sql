CREATE TABLE subject (
    subject_id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    birth_date timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    sex        text   NOT NULL,
    PRIMARY KEY (subject_id)
);

CREATE TABLE observation (
    phenotype_id    bigint                   NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    subject_id      bigint                   NOT NULL REFERENCES subject,
    created_at      timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    code_system     text   NOT NULL,
    code            text   NOT NULL,
    unit            text,
    number_value    numeric,
    PRIMARY KEY (phenotype_id)
);

CREATE TABLE condition (
    phenotype_id    bigint                   NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    subject_id      bigint                   NOT NULL REFERENCES subject,
    created_at      timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    code_system     text   NOT NULL,
    code            text   NOT NULL,
    PRIMARY KEY (phenotype_id)
);

CREATE TABLE medication (
    phenotype_id    bigint                   NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    subject_id      bigint                   NOT NULL REFERENCES subject,
    created_at      timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    code_system     text   NOT NULL,
    code            text   NOT NULL,
    PRIMARY KEY (phenotype_id)
);

CREATE TABLE procedure (
    phenotype_id    bigint                   NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    subject_id      bigint                   NOT NULL REFERENCES subject,
    created_at      timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    code_system     text   NOT NULL,
    code            text   NOT NULL,
    PRIMARY KEY (phenotype_id)
);

INSERT INTO subject VALUES
    (1, current_date - '23' year, 'female'),
    (2, current_date - '93' year, 'female'),
    (3, current_date - '22' year, 'male'),
    (4, current_date - '92' year, 'male'),
    (5, current_date - '21' year, 'female'),
    (6, current_date - '91' year, 'female'),
    (7, current_date - '20' year, 'male'),
    (8, current_date - '90' year, 'male'),
    (9, current_date - '19' year, 'female'),
    (10, current_date - '89' year, 'female'),
    (11, current_date - '25' year, 'female');

INSERT INTO observation (subject_id, created_at, code_system, code, unit, number_value) VALUES
    (1, '2000-05-20T12:43:00', 'http://loinc.org', '2951-2', 'mmol/L', 55),
    (2, '2000-12-01T06:35:00', 'http://loinc.org', '2951-2', 'mmol/L', 56),
    (3, '2000-05-20T12:43:00', 'http://loinc.org', '2951-2', 'mmol/L', 57),
    (4, '2000-12-01T06:35:00', 'http://loinc.org', '2951-2', 'mmol/L', 58),
    (5, '2000-05-20T12:43:00', 'http://loinc.org', '2951-2', 'mmol/L', 59),
    (6, '2000-05-20T12:43:00', 'http://loinc.org', '2951-2', 'mmol/L', 61),
    (7, '2000-12-01T06:35:00', 'http://loinc.org', '2951-2', 'mmol/L', 62),
    (8, '2000-05-20T12:43:00', 'http://loinc.org', '2951-2', 'mmol/L', 63),
    (9, '2000-12-01T06:35:00', 'http://loinc.org', '2951-2', 'mmol/L', 64),
    (10, '2000-05-20T12:43:00', 'http://loinc.org', '2951-2', 'mmol/L', 65);

INSERT INTO condition (subject_id, created_at, code_system, code) VALUES
    (1, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'F05.0'),
    (2, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'A51.2'),
    (3, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'G00.1'),
    (4, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'F01.-'),
    (5, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'F05.0'),
    (6, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'A51.2'),
    (7, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'G00.1'),
    (8, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'F05.0'),
    (9, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'F01.-'),
    (10, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'A51.2'),
    (11, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/icd-10-gm', 'G92.-');

INSERT INTO medication (subject_id, created_at, code_system, code) VALUES
    (1, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'N05A'),
    (2, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'N05A'),
    (3, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'N05A'),
    (4, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'N05A'),
    (5, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'N05A'),
    (6, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'XYZ'),
    (7, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'XYZ'),
    (8, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'XYZ'),
    (9, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'XYZ'),
    (10, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/atc', 'XYZ');

INSERT INTO procedure (subject_id, created_at, code_system, code) VALUES
    (1, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/ops', '5-'),
    (2, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/ops', 'XYZ'),
    (3, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/ops', '5-'),
    (4, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/ops', 'XYZ'),
    (5, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/ops', '5-'),
    (6, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/ops', 'XYZ'),
    (7, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/ops', '5-'),
    (8, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/ops', 'XYZ'),
    (9, '2000-12-01T06:35:00', 'http://fhir.de/CodeSystem/bfarm/ops', '5-'),
    (10, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/ops', 'XYZ'),
    (11, '2000-05-20T12:43:00', 'http://fhir.de/CodeSystem/bfarm/ops', '5-');
